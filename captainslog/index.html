<!DOCTYPE html>

<html>

<head>
	<title>Captain's Log</title>
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
	<script>
	  	$("document").ready(function(){ 
	  		//var theMessage = $("#msg)").val();
	  		//toUpdate = $("#log)");

	  		reload();	
	  		$('#msg').keypress(function (e) {
 				var key = e.which;
 				if(key == 13)  // the enter key code
  				{
   					$("#log").prepend( "<p>" + $("#msg").val() + "</p>");	
   					localStorage.setItem("messages", $("#log").html());
  				}
			});
	  		
		});

	function reload()
	{
		output = localStorage["messages"];

		if (output == undefined){
			output = "";
		} 
		

		//for (key in localStorage) {
			output = "<p>" + output + "</p>";
			console.log(output);
			if (output == undefined){
				output = "";
			}
		//}
		$("#log").html(output);

	}

		/*
		theMessage = document.getElementById("msg").value;
		toUpdate = document.getElementById("content");
		
		// The idea: create a new node and prepend to the first node in the "content" div
		newElem = document.createElement("p");
		newElem.innerHTML = '<p><span class="message">' +theMessage + " #FML</span></p>";
		toUpdate.insertBefore(newElem, toUpdate.childNodes[0]);
		document.getElementById("msg").value = "";
		*/
	</script>
</head>

<body>
	<h1>Captain's Log</h1>
	<h3>New entry: <input type="text" id="msg" name="msg" size="30" /></h3>
	<div id="log"></div>
</body>
</html>